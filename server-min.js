const express=require("express"),cors=require("cors"),{MongoClient:MongoClient,ObjectID:ObjectID}=require("mongodb"),port=process.env.PORT||5e3,url="mongodb://127.0.0.1:27017",client=new MongoClient(url,{useNewUrlParser:!0,useUnifiedTopology:!0}),app=express();app.use(cors()),app.use(express.json()),app.use(express.urlencoded()),client.connect().then((()=>{const e=client.db("EventDatabase").collection("Events");app.get("/events",((o,n)=>{e.find({}).toArray(((e,o)=>{if(e)throw e;n.send(o)}))})),app.post("/events",((o,n)=>{console.log(o.body),e.insertOne(o.body).then((()=>{n.send(o.body)})).catch((e=>console.error("There was an error ",e)))})),app.delete("/events/:id",((o,n)=>{const s=new ObjectID(o.params.id);e.deleteOne({_id:s}).then((()=>{console.log("Succesfully deleted ",s),n.send(s)})).catch((e=>console.error("Deletion failed ",e)))})),app.put("/events/:id",((o,n)=>{const s=new ObjectID(o.params.id),t={$set:{status:!o.body.status}};e.updateOne({_id:s},t).then((()=>{console.log("Completed Event ",s),n.send(s)}))}))})).catch((e=>console.error(e))),app.listen(port,(()=>console.log("Server started on "+port)));